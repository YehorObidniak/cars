<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
  <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  {% load static %}
  <link rel="stylesheet" href="{% static 'desktop/styles.css' %}">
</head>


<body style="background-color: rgb(237, 241, 248)">

  <button class="btn_filter" onclick="showFilter()" style="margin-top: 1vh; margin-left: 2vw;">Filters</button>

  <form class="filter invisible" id="filter">
    <div class="location">
      <div class="textfilter">Location</div>
      {{filter.location}}
    </div>
    <div class="model">
      <div class="textfilter">Model</div>
      {{filter.model}}
    </div>

    <div class="brand">
      <div class="textfilter">Brand </div>{{filter.brand}}
    </div>
    <div class="spec">
      <div class="textfilter">Specs </div>{{filter.regSpecs}}
    </div>

    <div class="mileage">
      <div onclick="showFilterMil()" style="width: 100%; height: 100%;">
        <div class="textfilter">Mileage</div>
        <div class="textfilter_under">Select </div>
      </div>

      <div class="spisok_mil invisibleFil" id="spisok_mil123">
        <div style="display: flex;">
          <div style="margin-left: 3%; " class="textfilter_menu">From</div>
          <div style="margin-left: 36%;" class="textfilter_menu">To</div>
        </div>
        {{filter.kms}}
        <div style="text-align: left; height: 40%;">
          <button class="btn"
            style="margin-left: 3%; background-color: black; color: white; width: 30%;">Submit</button>
          <script>
          </script>
        </div>
      </div>
    </div>

    <div class=" prise">
      <div onclick="showFilterPrice()" style="width: 100%; height: 100%;">
        <div class="textfilter">Price</div>
        <div class="textfilter_under">Select </div>
      </div>

      <div class="spisok_price invisibleFil" id="spisok_price123">
        <div style="display: flex;">
          <div style="margin-left: 3%; " class="textfilter_menu">From</div>
          <div style="margin-left: 36%;" class="textfilter_menu">To</div>
        </div>
        {{filter.price}}
        <div style="text-align: left; height: 40%;">
          <button class="btn"
            style="margin-left: 3%; background-color: black; color: white; width: 30%;">Submit</button>
        </div>
      </div>

    </div>

    <div class="year">
      <div onclick="showFilterYear()" style="width: 100%; height: 100%;">
        <div class="textfilter">Year</div>
        <div class="textfilter_under">Select </div>
      </div>

      <div class="spisok_year invisibleFil" id="spisok_year123">
        <div style="display: flex;">
          <div style="margin-left: 3%;" class="textfilter_menu">From</div>
          <div style="margin-left: 36%;" class="textfilter_menu">To</div>
        </div>
        {{filter.year}}
        <div style="text-align: left; height: 40%;">
          <button class="btn"
            style="margin-left: 3%; background-color: black; color: white; width: 30%;">Submit</button>
        </div>
      </div>

    </div>
    <button class="btnsub">Submit</button>
  </form>


  <div class="row">
    <div class="cl" id="db">
      <div id="names">Dubicars</div>
      <div class="column" id="dubicars">
        {%for car in dubicarsFilterQs%}
        <div class="cardDb">

          <div style=" display: flex; text-align: left;">
            <div style="margin-left: 1%;">
              <img src={{car.photo}} class="card-img-top"
                style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
            </div>
            <div style="margin-left: 2vh;">
              <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                  <a href={{car.url}}>{{car.brand}} {{car.model}}</a></b>
              </div>

              <div>
                <b>AED {{car.price}}</b>
              </div>
              <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                {{car.year}}, {{car.location}}, {{car.regSpecs}}, {{car.kms}} km, ({{car.activeListings}}) {{car.contact}}
              </div>
            </div>
          </div>

        </div>

        {%endfor%}
      </div>
      <div>
        <button type="button" id="btn_dubicars" class="custom-btn btn-5">Load more</button>
      </div>
    </div>
    <!-- {{total_obj_dubicars|json_script:"json-total-dubicars"}} -->
    <div class="cl" id="dz">
      <div id="names">Dubizzle</div>
      <div class="column" id="dubizzle">
        {%for car in dubizzleFilterQs%}
        <div class="cardDz">

          <div style=" display: flex; text-align: left;">
            <div style="margin-left: 1%;">
              <img src={{car.photo}} class="card-img-top"
                style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
            </div>
            <div style="margin-left: 2vh;">
              <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                  <a href={{car.url}}>{{car.brand}} {{car.model}}</a></b>
              </div>

              <div>
                <b>AED {{car.price}}</b>
              </div>
              <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                {{car.year}}, {{car.location}}, {{car.regSpecs}}, {{car.kms}} km, ({{car.activeListings}}) {{car.posted}}
              </div>
            </div>
          </div>

        </div>
        {%endfor%}
      </div>
      <div>
        <button type="button" id="btn_dubizzle" class="custom-btn btn-5">Load more</button>
      </div>
    </div>
    <!-- {{total_obj_dubicars|json_script:"json-total-dubicars"}} -->
    <div class="cl" id="yl">
      <div id="names">Yallamotor</div>
      <div class="column" id="yallamotor">
        {%for car in yallamotorFilterQs%}
        <div class="cardYl">

          <div style=" display: flex; text-align: left;">
            <div style="margin-left: 1%;">
              <img src={{car.photo}} class="card-img-top"
                style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
            </div>
            <div style="margin-left: 2vh;">
              <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                  <a href={{car.url}}>{{car.brand}} {{car.model}}</a></b>
              </div>

              <div>
                <b>AED {{car.price}}</b>
              </div>
              <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                {{car.year}}, {{car.location}}, {{car.regSpecs}}, {{car.kms}} km, ({{car.activeListings}}) tel:{{car.contact}}
              </div>
            </div>
          </div>

        </div>
        {%endfor%}
      </div>

      <div>
        <button type="button" id="btn_yallamotor" class="custom-btn btn-5">Load more</button>
      </div>
    </div>
  </div>

  <!-- {{total_obj_dubicars|json_script:"json-total-dubicars"}} -->

  <script>
    const loadBtnDubicars = document.getElementById('btn_dubicars');
    const loadBtnDubizzle = document.getElementById('btn_dubizzle');
    const loadBtnYallamotor = document.getElementById('btn_yallamotor');
    // const showBtn = document.getElementById('filters-visible');

    function loadMoreCarsDubicars() {
      var _current_item = $('.cardDb').length
      const container = document.getElementById('dubicars');
      var filter_data = $('.filter').serialize()
      filter_data += "&total_item=" + _current_item;

      $.ajax({
        url: '{% url "load_dubicars" %}',
        type: 'GET',
        data: filter_data,
        beforeSend: function () {

        },
        success: function (response) {
          const data = response.dubicars

          data.map(car => {
            container.innerHTML += `<div class="cardDb">

              <div style=" display: flex; text-align: left;">
                <div style="margin-left: 1%;">
                  <img src=${car.photo} class="card-img-top"
                    style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
                </div>
                <div style="margin-left: 2vh;">
                  <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                    <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                      <a href=${car.url}>${car.brand} ${car.model}</a></b>
                  </div>

                  <div>
                    <b>AED ${car.price}</b>
                  </div>
                  <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                    ${car.year}, ${car.location}, ${car.regSpecs}, ${car.kms} km, (${car.activeListings}) ${car.contact}
                  </div>
                </div>
              </div>

              </div>`
          })
        },
        error: function (err) {
          console.log(err)
        }
      });
    }

    function loadMoreCarsDubizzle() {
      var _current_item = $('.cardDz').length
      const container = document.getElementById('dubizzle');
      var filter_data = $('.filter').serialize()
      filter_data += "&total_item=" + _current_item;

      $.ajax({
        url: '{% url "load_dubizzle" %}',
        type: 'GET',
        data: filter_data,
        beforeSend: function () {

        },
        success: function (response) {
          const data = response.dubizzle

          data.map(car => {
            container.innerHTML += `<div class="cardDz">
              <div style=" display: flex; text-align: left;">
                <div style="margin-left: 1%;">
                  <img src=${car.photo} class="card-img-top"
                    style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
                </div>
                <div style="margin-left: 2vh;">
                  <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                    <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                      <a href=${car.url}>${car.brand} ${car.model}</a></b>
                  </div>

                  <div>
                    <b>AED ${car.price}</b>
                  </div>
                  <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                    ${car.year}, ${car.location}, ${car.regSpecs}, ${car.kms} km, (${car.activeListings}) ${car.posted}
                  </div>
                </div>
              </div>

              </div>`
          })
        },
        error: function (err) {
          console.log(err)
        }
      });
    }

    function loadMoreCarsYallamotor() {
      var _current_item = $('.cardYl').length
      console.log(_current_item)
      const container = document.getElementById('yallamotor');
      var filter_data = $('.filter').serialize()
      filter_data += "&total_item=" + _current_item;

      $.ajax({
        url: '{% url "load_yallamotor" %}',
        type: 'GET',
        data: filter_data,
        beforeSend: function () {

        },
        success: function (response) {
          const data = response.yallamotor

          data.map(car => {
            container.innerHTML += `<div class="cardYl">

              <div style=" display: flex; text-align: left;">
                <div style="margin-left: 1%;">
                  <img src=${car.photo} class="card-img-top"
                    style="width: 15vh; height: 15vh; object-fit: cover; object-position: center; margin-top: 5px;">
                </div>
                <div style="margin-left: 2vh;">
                  <div style="font-size: 2vh; width: 100%; height: 20%; margin-bottom: 2%;">
                    <b style="font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; text-align: center;">
                      <a href=${car.url}>${car.brand} ${car.model}</a></b>
                  </div>

                  <div>
                    <b>AED ${car.price}</b>
                  </div>
                  <div style="font-size: 2vh; margin-top: 2%; color: rgb(90, 90, 90);">
                    ${car.year}, ${car.location}, ${car.regSpecs}, ${car.kms} km, (${car.activeListings}) ${car.contact}
                  </div>
                </div>
              </div>

              </div>`
          })
        },
        error: function (err) {
          console.log(err)
        }
      });
    }

    function showFilter() {
      const filter = document.getElementById('filter');
      const db = document.getElementById('db');
      const dz = document.getElementById('dz');
      const yl = document.getElementById('yl');

      if (filter.classList == "filter visible") {
        filter.classList = "filter invisible";
        db.style.height = '97vh';
        db.style.margin = '1%';

        dz.style.height = '97vh';
        dz.style.margin = '1%';

        yl.style.height = '97vh';
        yl.style.margin = '1%';

      } else {
        filter.classList = "filter visible";
        db.style.height = '88vh';
        db.style.marginTop = '9vh';

        dz.style.height = '88vh';
        dz.style.marginTop = '9vh';

        yl.style.height = '88vh';
        yl.style.marginTop = '9vh';

      }
    }

    function showFilterMil() {
      const milliageDiv = document.getElementById('spisok_mil123');
      const priceDiv = document.getElementById('spisok_price123');
      const yearDiv = document.getElementById('spisok_year123');
      if (milliageDiv.classList == "spisok_mil visibleFil") {
        milliageDiv.classList = "spisok_mil invisibleFil";
      } else {
        milliageDiv.classList = "spisok_mil visibleFil";
        priceDiv.classList = "spisok_price invisibleFil";
        yearDiv.classList = "spisok_year invisibleFil";
      }
    }

    function showFilterPrice() {
      const priceDiv = document.getElementById('spisok_price123');
      const milliageDiv = document.getElementById('spisok_mil123');
      const yearDiv = document.getElementById('spisok_year123');
      if (priceDiv.classList == "spisok_price visibleFil") {
        priceDiv.classList = "spisok_price invisibleFil";
      } else {
        priceDiv.classList = "spisok_price visibleFil";
        milliageDiv.classList = "spisok_mil invisibleFil";
        yearDiv.classList = "spisok_year invisibleFil";
      }
    }

    function showFilterYear() {
      const priceDiv = document.getElementById('spisok_price123');
      const milliageDiv = document.getElementById('spisok_mil123');
      const yearDiv = document.getElementById('spisok_year123');
      if (yearDiv.classList == "spisok_year visibleFil") {
        yearDiv.classList = "spisok_year invisibleFil";
      } else {
        yearDiv.classList = "spisok_year visibleFil";
        priceDiv.classList = "spisok_price invisibleFil";
        milliageDiv.classList = "spisok_mil invisibleFil";
      }
    }

    loadBtnDubicars.addEventListener('click', () => {
      loadMoreCarsDubicars()
    });
    loadBtnDubizzle.addEventListener('click', () => {
      loadMoreCarsDubizzle()
    });
    loadBtnYallamotor.addEventListener('click', () => {
      loadMoreCarsYallamotor()
    });
  </script>
</body>

</html>